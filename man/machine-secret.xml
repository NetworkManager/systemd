<?xml version='1.0'?> <!--*-nxml-*-->
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
  "http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">

<!--
  This file is part of systemd.

  Copyright 2010 Lennart Poettering
  Copyright 2015 Lubomir Rintel

  systemd is free software; you can redistribute it and/or modify it
  under the terms of the GNU Lesser General Public License as published by
  the Free Software Foundation; either version 2.1 of the License, or
  (at your option) any later version.

  systemd is distributed in the hope that it will be useful, but
  WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
  Lesser General Public License for more details.

  You should have received a copy of the GNU Lesser General Public License
  along with systemd; If not, see <http://www.gnu.org/licenses/>.
-->

<refentry id="machine-secret">
  <refentryinfo>
    <title>machine-secret</title>
    <productname>systemd</productname>

    <authorgroup>
      <author>
        <contrib>Developer</contrib>
        <firstname>Lubomir</firstname>
        <surname>Rintel</surname>
        <email>lkundrak@v3.sk</email>
      </author>
    </authorgroup>
  </refentryinfo>

  <refmeta>
    <refentrytitle>machine-secret</refentrytitle>
    <manvolnum>5</manvolnum>
  </refmeta>

  <refnamediv>
    <refname>machine-secret</refname>
    <refpurpose>Local machine secret configuration file</refpurpose>
  </refnamediv>

  <refsynopsisdiv>
    <para><filename>/etc/machine-secret</filename></para>
  </refsynopsisdiv>

  <refsect1>
    <title>Description</title>

    <para>The <filename>/etc/machine-secret</filename> file contains the
    unique machine secret of the local system that is set during
    installation. The machine secret is a single newline-terminated,
    hexadecimal, 32-character, lowercase machine ID string. When
    decoded from hexadecimal, this corresponds with a 16-byte/128-bit
    string.</para>

    <para>The machine secret is usually generated from a pseudo-random
    source during system installation and stays constant for all subsequent
    boots. Optionally, for stateless systems, it is generated during
    runtime at boot if it is found to be empty.</para>

    <para>The machine secret does not change based on user configuration
    or when hardware is replaced.</para>

    <para>The machine secret adheres to the same format as the
    machine ID.</para>

    <para>The
    <citerefentry><refentrytitle>systemd-machine-id-setup</refentrytitle><manvolnum>1</manvolnum></citerefentry>
    tool may be used by installer tools to initialize the machine ID
    at install time. Use
    <citerefentry><refentrytitle>systemd-firstboot</refentrytitle><manvolnum>1</manvolnum></citerefentry>
    to initialize it on mounted (but not booted) system images.
    These tools are guarranteed to use s comply to the
    <ulink url="https://tools.ietf.org/html/rfc4086">RFC4086 Randomness
    Requirements for Security</ulink> of the pseudo-random number generators. This
    makes it possible tu use the machine secret as a secret key when utilizing
    <ulink url="https://tools.ietf.org/html/rfc7217">RFC7217 Method for
    Generating Semantically Opaque Interface Identifiers with IPv6 Stateless
    Address Autoconfiguration (SLAAC)</ulink>.</para>

    <para>Machine secret is owned by the <literal>root</literal> user and
    not readable or writeable by any other user.</para>

  </refsect1>

  <refsect1>
    <title>History</title>

    <para>The simple configuration file format of
    <filename>/etc/machine-secret</filename> originates in the
    <filename>/etc/machine-secret</filename>.</para>
  </refsect1>

  <refsect1>
      <title>See Also</title>
      <para>
        <citerefentry><refentrytitle>systemd</refentrytitle><manvolnum>1</manvolnum></citerefentry>,
        <citerefentry><refentrytitle>systemd-machine-id-setup</refentrytitle><manvolnum>1</manvolnum></citerefentry>,
        <citerefentry><refentrytitle>sd-id128</refentrytitle><manvolnum>3</manvolnum></citerefentry>,
        <citerefentry><refentrytitle>sd_id128_get_machine_secret</refentrytitle><manvolnum>3</manvolnum></citerefentry>,
        <citerefentry><refentrytitle>systemd-firstboot</refentrytitle><manvolnum>1</manvolnum></citerefentry>
      </para>
  </refsect1>

</refentry>
